{"id":"pfn_mcp-0tu","title":"Implement get_electricity_cost_breakdown tool","description":"Detailed breakdown analysis by shift, rate, or utility source.\n\n**Reference:** docs/electricity_cost_tools.md\n\n**Parameters:**\n- device: Device name (required)\n- period: Time period (default: 7d)\n- group_by: shift, rate, source, shift_rate (default)\n\n**Response includes:**\n- Consumption and cost per group\n- Percentage distribution\n- Supports production manager (shift) and finance (rate) views\n\n**Implementation notes:**\n- Reuse device resolution from get_electricity_cost\n- GROUP BY shift_period, rate_code, or utility_source_id\n- Calculate percentages from totals","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-27T08:58:53.231801+07:00","updated_at":"2025-12-27T08:58:53.231801+07:00","dependencies":[{"issue_id":"pfn_mcp-0tu","depends_on_id":"pfn_mcp-d71","type":"blocks","created_at":"2025-12-27T08:59:02.832553+07:00","created_by":"daemon"}]}
{"id":"pfn_mcp-27z","title":"Implement check_data_freshness tool","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-25T19:43:12.050463+07:00","updated_at":"2025-12-25T20:00:23.958526+07:00","closed_at":"2025-12-25T20:00:23.958526+07:00","close_reason":"All 5 Phase 1 discovery tools implemented and tested"}
{"id":"pfn_mcp-3rz","title":"Implement get_device_data_range tool","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-25T19:43:06.867326+07:00","updated_at":"2025-12-25T20:00:23.950941+07:00","closed_at":"2025-12-25T20:00:23.950941+07:00","close_reason":"All 5 Phase 1 discovery tools implemented and tested"}
{"id":"pfn_mcp-40b","title":"resolve_device tool - confirm device selection","description":"Confirm device selection before telemetry queries. Prevents wrong-device from ambiguous fuzzy matches.\n\n## Purpose\nWhen user provides device name (not ID), search could match multiple devices. LLM should call this BEFORE get_device_telemetry when uncertain.\n\n## Parameters\n- search: str (device name search term)\n- tenant_id: int | None (optional filter)\n- limit: int = 5 (max candidates)\n\n## Response\n- Ranked list of matching devices\n- Match confidence (exact/partial/fuzzy)\n- Tenant context for each\n- Device IDs for precise selection\n\n## See also\ndocs/phase2-telemetry.md for full spec","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-25T20:22:12.136461+07:00","updated_at":"2025-12-27T08:28:20.253743+07:00","closed_at":"2025-12-27T08:28:20.253743+07:00","close_reason":"Closed"}
{"id":"pfn_mcp-7yr","title":"Implement get_tenant_summary tool","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-25T19:43:13.08592+07:00","updated_at":"2025-12-25T20:00:23.959795+07:00","closed_at":"2025-12-25T20:00:23.959795+07:00","close_reason":"All 5 Phase 1 discovery tools implemented and tested"}
{"id":"pfn_mcp-aq0","title":"Phase 1: Foundation \u0026 Data Mapping","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-25T10:31:24.982778+07:00","updated_at":"2025-12-25T11:20:55.233356+07:00","closed_at":"2025-12-25T11:20:55.233356+07:00","close_reason":"Phase 1 complete: MCP server with list_quantities, list_devices, list_tenants tools"}
{"id":"pfn_mcp-bwx","title":"Set up MCP server project structure","description":"Initialize Python project with mcp SDK, pyproject.toml, src layout, and basic server scaffold","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-25T10:31:38.574861+07:00","updated_at":"2025-12-25T10:39:14.027019+07:00","closed_at":"2025-12-25T10:39:14.027019+07:00","close_reason":"Project structure created with pyproject.toml, src layout, MCP server scaffold, and .env.example"}
{"id":"pfn_mcp-c44","title":"Implement list_quantities tool","description":"MCP tool to browse available metrics with WAGE categories, units, and aggregation methods. Query quantities table with semantic grouping.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-25T10:31:39.428738+07:00","updated_at":"2025-12-25T11:09:36.202173+07:00","closed_at":"2025-12-25T11:09:36.202173+07:00","close_reason":"Implemented with category/search filters, semantic aliases (energy, power, voltage, etc.), in_use_only filter, and formatted output","dependencies":[{"issue_id":"pfn_mcp-c44","depends_on_id":"pfn_mcp-tmd","type":"blocks","created_at":"2025-12-25T10:32:02.972315+07:00","created_by":"daemon"}]}
{"id":"pfn_mcp-cfk","title":"get_device_telemetry tool - core time-series query","description":"Core Phase 2 tool. Fetch aggregated telemetry data for a device.\n\n## Key Features\n- Adaptive bucketing based on time range\n- Multiple aggregation stats (avg, min, max, sum, count)\n- Period-based or explicit date range\n- Quantity semantic search support\n\n## Parameters\n- device_id/device_name: device selection\n- quantity_id/quantity_search: metric selection\n- period OR start_date/end_date: time range\n- bucket: '15min', '1hour', '1day', 'auto'\n\n## Adaptive Buckets\n- ≤24h → 15min buckets\n- ≤7d → 1hour buckets\n- ≤30d → 4hour buckets\n- ≤90d → 1day buckets\n- \u003e90d → 1week buckets\n\n## Data Source\nPrimary: telemetry_15min_agg (2 years)\nFallback: telemetry_data (14 days raw)\n\n## See also\ndocs/phase2-telemetry.md for full spec","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-25T20:22:13.350034+07:00","updated_at":"2025-12-27T08:37:31.128773+07:00","closed_at":"2025-12-27T08:37:31.128773+07:00","close_reason":"Closed","dependencies":[{"issue_id":"pfn_mcp-cfk","depends_on_id":"pfn_mcp-40b","type":"blocks","created_at":"2025-12-25T20:22:22.698364+07:00","created_by":"daemon"}]}
{"id":"pfn_mcp-d71","title":"Implement get_electricity_cost tool","description":"Primary electricity cost query tool. Returns consumption and cost for a device or tenant with optional breakdown.\n\n**Reference:** docs/electricity_cost_tools.md\n\n**Parameters:**\n- device: Device name (fuzzy match)\n- tenant: Tenant name (fuzzy match)  \n- period: Time period (7d, 1M, 2025-12, etc.)\n- start_date/end_date: Explicit date range\n- breakdown: none, daily, shift, rate, source\n\n**Data source:** daily_energy_cost_summary table (quantity_id=124 for Active Energy)\n\n**Implementation notes:**\n- Use existing resolve_device pattern for fuzzy matching\n- Support multiple period formats (relative, month, range)\n- Handle NULL cost for devices without utility mapping\n- Aggregate by summing total_cost (not recalculating)","status":"open","priority":1,"issue_type":"feature","created_at":"2025-12-27T08:58:36.781407+07:00","updated_at":"2025-12-27T08:58:36.781407+07:00"}
{"id":"pfn_mcp-d76","title":"Implement list_tenants tool","description":"MCP tool to list available tenants with basic info (name, device count, etc.)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-25T10:31:40.295787+07:00","updated_at":"2025-12-25T11:20:50.94033+07:00","closed_at":"2025-12-25T11:20:50.94033+07:00","close_reason":"Implemented with device counts per tenant, formatted output with description","dependencies":[{"issue_id":"pfn_mcp-d76","depends_on_id":"pfn_mcp-tmd","type":"blocks","created_at":"2025-12-25T10:32:03.767011+07:00","created_by":"daemon"}]}
{"id":"pfn_mcp-g4j","title":"Implement compare_electricity_periods tool","description":"Compare electricity costs between two time periods.\n\n**Reference:** docs/electricity_cost_tools.md\n\n**Parameters:**\n- device or tenant: Entity to compare (at least one required)\n- period1: First period (e.g., 2025-11)\n- period2: Second period (e.g., 2025-12)\n\n**Response includes:**\n- Consumption and cost for each period\n- Absolute and percentage change\n- Supports month-over-month and custom range comparisons\n\n**Implementation notes:**\n- Parse period strings to date ranges\n- Run two aggregation queries\n- Calculate change metrics","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-27T08:58:54.276957+07:00","updated_at":"2025-12-27T08:58:54.276957+07:00","dependencies":[{"issue_id":"pfn_mcp-g4j","depends_on_id":"pfn_mcp-d71","type":"blocks","created_at":"2025-12-27T08:59:03.405469+07:00","created_by":"daemon"}]}
{"id":"pfn_mcp-ktd","title":"Implement list_devices tool","description":"MCP tool to browse devices with fuzzy search on display_name. Return device info with tenant context. Handle prefix conflicts (MC-1 vs MC-10).","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-25T10:31:39.856706+07:00","updated_at":"2025-12-25T11:19:39.248357+07:00","closed_at":"2025-12-25T11:19:39.248357+07:00","close_reason":"Implemented with fuzzy search, match ranking (exact \u003e prefix \u003e contains), tenant filter, and formatted output","dependencies":[{"issue_id":"pfn_mcp-ktd","depends_on_id":"pfn_mcp-tmd","type":"blocks","created_at":"2025-12-25T10:32:03.363747+07:00","created_by":"daemon"}]}
{"id":"pfn_mcp-nft","title":"Implement find_devices_by_quantity tool","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-25T19:43:07.945151+07:00","updated_at":"2025-12-25T20:00:23.955899+07:00","closed_at":"2025-12-25T20:00:23.955899+07:00","close_reason":"All 5 Phase 1 discovery tools implemented and tested"}
{"id":"pfn_mcp-qkd","title":"Implement get_device_info tool","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-25T19:43:10.951022+07:00","updated_at":"2025-12-25T20:00:23.957315+07:00","closed_at":"2025-12-25T20:00:23.957315+07:00","close_reason":"All 5 Phase 1 discovery tools implemented and tested"}
{"id":"pfn_mcp-tft","title":"Populate quantities-mapping.md from database","description":"Query production database to fill TBD entries in docs/quantities-mapping.md. Verify all quantity IDs match production.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-25T10:31:40.765084+07:00","updated_at":"2025-12-25T11:12:17.734581+07:00","closed_at":"2025-12-25T11:12:17.734581+07:00","close_reason":"Updated with 77 quantities from production database, organized by category with semantic aliases reference"}
{"id":"pfn_mcp-tmd","title":"Create database connection layer","description":"Implement PostgreSQL connection pooling with asyncpg, read-only access, query timeout limits, and connection string from env vars","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-25T10:31:39.007641+07:00","updated_at":"2025-12-25T11:04:19.003516+07:00","closed_at":"2025-12-25T11:04:19.003516+07:00","close_reason":"Database layer with asyncpg pool, query helpers, timeouts, and proper cleanup in finally block","dependencies":[{"issue_id":"pfn_mcp-tmd","depends_on_id":"pfn_mcp-bwx","type":"blocks","created_at":"2025-12-25T10:32:02.501775+07:00","created_by":"daemon"}]}
{"id":"pfn_mcp-xcm","title":"get_quantity_stats tool - pre-flight validation","description":"Quick stats about data availability before expensive telemetry query.\n\n## Purpose\n- Validate data exists for requested period\n- Understand typical value ranges\n- Check for data gaps\n\n## Parameters\n- device_id: int\n- quantity_id/quantity_search: metric selection\n- period: str = '30d'\n\n## Response\n- data_points count\n- min/max/avg values\n- first/last reading timestamps\n- gap count (missing readings)\n\n## When to Use\n- Before get_device_telemetry for validation\n- To set context for anomaly detection\n- User asks 'is there data for X?'\n\n## See also\ndocs/phase2-telemetry.md for full spec","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-25T20:22:14.626065+07:00","updated_at":"2025-12-27T08:37:31.132048+07:00","closed_at":"2025-12-27T08:37:31.132048+07:00","close_reason":"Closed","dependencies":[{"issue_id":"pfn_mcp-xcm","depends_on_id":"pfn_mcp-40b","type":"blocks","created_at":"2025-12-25T20:22:22.973479+07:00","created_by":"daemon"}]}
{"id":"pfn_mcp-ye0","title":"Implement get_electricity_cost_ranking tool","description":"Rank devices by consumption or cost within a tenant.\n\n**Reference:** docs/electricity_cost_tools.md\n\n**Parameters:**\n- tenant: Tenant name (required)\n- period: Time period (default: 30d)\n- metric: cost (default), consumption\n- limit: Number of results (default: 10)\n\n**Response includes:**\n- Ranked list of devices\n- Consumption and cost per device\n- Percentage of tenant total\n\n**Implementation notes:**\n- Aggregate by device_id within tenant\n- ORDER BY metric DESC\n- Calculate percentage_of_total from tenant sum","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-27T08:58:53.752695+07:00","updated_at":"2025-12-27T08:58:53.752695+07:00","dependencies":[{"issue_id":"pfn_mcp-ye0","depends_on_id":"pfn_mcp-d71","type":"blocks","created_at":"2025-12-27T08:59:03.123482+07:00","created_by":"daemon"}]}
{"id":"pfn_mcp-zjh","title":"Add SSE/HTTP transport for remote deployment","description":"Convert stdio transport to SSE/HTTP for production VPS deployment","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-25T14:57:37.474645+07:00","updated_at":"2025-12-25T15:03:03.355389+07:00","closed_at":"2025-12-25T15:03:03.355389+07:00","close_reason":"SSE/HTTP transport with Starlette, health endpoint, systemd service, and deployment scripts"}
